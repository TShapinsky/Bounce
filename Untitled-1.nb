(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15469,        367]
NotebookOptionsPosition[     14757,        348]
NotebookOutlinePosition[     15096,        363]
CellTagsIndexPosition[     15053,        360]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"norm", "[", "x_", "]"}], ":=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"x", ".", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"unit", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/", 
   RowBox[{"norm", "[", "x", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmat", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_", ",", "z_", ",", "w_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0", ",", "x"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0", ",", "y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "z"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmat", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "x"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "z"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Oc", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "8.44"}], ",", "2.62", ",", 
     RowBox[{"-", "2.18"}], ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pg", "=", 
    RowBox[{"{", 
     RowBox[{"3.394112549695428`", ",", 
      RowBox[{"-", "0.3111269837220809`"}], ",", 
      RowBox[{"-", "8.44`"}], ",", "1.`"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CtoG", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"unit", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"unit", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}], 
    ".", 
    RowBox[{"tmat", "[", 
     RowBox[{"-", "Oc"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GtoC", "=", 
    RowBox[{"Inverse", "[", "PtoG", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tvec1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.06476276"}], ",", 
     RowBox[{"-", "3.54076108"}], ",", "22.27329266"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tvec2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.48017598"}], ",", "0.61380029", ",", "25.56235439"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotMat1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.84907441", ",", 
       RowBox[{"-", "0.39632764"}], ",", 
       RowBox[{"-", "0.34928075"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.01952381", ",", "0.68426491", ",", 
       RowBox[{"-", "0.72897212"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.52791236", ",", "0.61213228", ",", "0.58872965", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotMat2", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.86370945", ",", "0.35703407", ",", 
        RowBox[{"-", "0.35571429"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.00835079", ",", "0.69556115", ",", "0.71841837", ",", "0"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.50392088", ",", 
        RowBox[{"-", "0.62347523"}], ",", "0.59778122", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CtoC1", " ", "=", 
   RowBox[{
    RowBox[{"tmat", "[", "tvec1", "]"}], ".", "rotMat1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CtoC2", "=", 
   RowBox[{
    RowBox[{"tmat", "[", "tvec2", "]"}], ".", "rotMat2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1toC", " ", "=", " ", 
   RowBox[{"Inverse", "[", "CtoC1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C2toC", " ", "=", " ", 
    RowBox[{"Inverse", "[", "CtoC2", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1toG", "=", 
   RowBox[{"CtoG", ".", "C1toC"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C2toG", "=", 
   RowBox[{"CtoG", ".", "C2toC"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GtoC1", " ", "=", " ", 
   RowBox[{"Inverse", "[", "C1toG", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GtoC2", "=", 
    RowBox[{"Inverse", "[", "C2toG", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"C1toG", ".", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "1"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C2toG", ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "C1toG", "\
\[IndentingNewLine]", 
 RowBox[{"C2toG", "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.721599104658821*^9, 3.721599133412923*^9}, {
   3.7215991668209457`*^9, 3.7215992588924*^9}, {3.7215993021442013`*^9, 
   3.721599700177253*^9}, {3.721599731795129*^9, 3.7215998760092173`*^9}, {
   3.721599961764495*^9, 3.721599988015634*^9}, {3.721600020654698*^9, 
   3.721600409929234*^9}, {3.721600442840188*^9, 3.721600448244878*^9}, {
   3.721600504454096*^9, 3.7216006039866533`*^9}, {3.7216006397667723`*^9, 
   3.7216007896144323`*^9}, {3.721600878938151*^9, 3.72160088490921*^9}, {
   3.721601068786516*^9, 3.7216010887957067`*^9}, {3.721601135268277*^9, 
   3.7216011402190638`*^9}, {3.7216011851436253`*^9, 3.721601251004838*^9}, {
   3.721601284670269*^9, 3.721601304891383*^9}, {3.721601391859556*^9, 
   3.721601396310254*^9}, {3.721601491692986*^9, 3.7216015013704157`*^9}, {
   3.72160153483397*^9, 3.721601534995124*^9}, {3.721601796276211*^9, 
   3.7216018074396467`*^9}, {3.7216018669772167`*^9, 3.721601867144599*^9}, 
   3.721601913526272*^9, {3.721601948570199*^9, 3.721601955422933*^9}, {
   3.721602003628315*^9, 3.72160201120035*^9}, {3.721602052877842*^9, 
   3.721602054008946*^9}, {3.721602107995514*^9, 3.721602148177417*^9}, {
   3.7216021836140614`*^9, 3.7216021942958803`*^9}, {3.7216022770188828`*^9, 
   3.721602316588855*^9}, {3.721602415236676*^9, 3.721602426416613*^9}, {
   3.721602500808906*^9, 3.7216025030242853`*^9}, {3.721602722478952*^9, 
   3.7216029556849413`*^9}, {3.721603048533908*^9, 3.721603131496087*^9}, {
   3.72160337710828*^9, 3.721603394264133*^9}, {3.721603436921687*^9, 
   3.7216034472622747`*^9}, {3.721603481001816*^9, 3.721603509987932*^9}, {
   3.721603575991839*^9, 3.721603600074212*^9}, {3.721603654942101*^9, 
   3.7216036560075293`*^9}, {3.721603690711131*^9, 3.7216037112911777`*^9}, 
   3.721603933134597*^9, {3.721603994318656*^9, 
   3.721604005470076*^9}},ExpressionUUID->"ef7c5052-93d1-4e3a-b7ec-\
1dbc8f44c7a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.3596015749322823`"}], ",", "21.4791945844977`", ",", 
   "0.2020685879147397`", ",", "1.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.721600410280508*^9, 3.721600448537871*^9, {3.7216005093621807`*^9, 
   3.721600549005908*^9}, 3.721600591101737*^9, {3.721600653661416*^9, 
   3.7216007049138117`*^9}, {3.721600742024713*^9, 3.721600790853889*^9}, 
   3.721600885259098*^9, 3.7216010904539957`*^9, 3.721601140751854*^9, {
   3.721601204859228*^9, 3.72160125184269*^9}, 3.7216015017950087`*^9, 
   3.7216015372812557`*^9, {3.7216018081844997`*^9, 3.721601867557898*^9}, 
   3.7216019158575993`*^9, 3.721601955761297*^9, 3.721602012060091*^9, 
   3.7216020551098757`*^9, 3.721602122209738*^9, 3.721602153971483*^9, 
   3.721602194655582*^9, {3.7216022913637857`*^9, 3.7216023170199327`*^9}, 
   3.721602427418811*^9, 3.7216025049579144`*^9, 3.721602766143175*^9, {
   3.7216028286075087`*^9, 3.721602891030652*^9}, 3.721602921390072*^9, 
   3.7216029560750513`*^9, {3.721603056104291*^9, 3.721603067845221*^9}, 
   3.721603124393818*^9, {3.721603470635396*^9, 3.7216035104478493`*^9}, 
   3.7216035802925262`*^9, 3.7216036571189623`*^9, {3.7216036959592333`*^9, 
   3.721603712319971*^9}, 3.721603935400074*^9, 
   3.7216040059589567`*^9},ExpressionUUID->"0dcd49d4-6986-4951-912a-\
84dd532e6cd9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "21.452351502283754`", ",", "0.4552841954153055`", ",", 
   "0.28675009018920505`", ",", "1.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.721600410280508*^9, 3.721600448537871*^9, {3.7216005093621807`*^9, 
   3.721600549005908*^9}, 3.721600591101737*^9, {3.721600653661416*^9, 
   3.7216007049138117`*^9}, {3.721600742024713*^9, 3.721600790853889*^9}, 
   3.721600885259098*^9, 3.7216010904539957`*^9, 3.721601140751854*^9, {
   3.721601204859228*^9, 3.72160125184269*^9}, 3.7216015017950087`*^9, 
   3.7216015372812557`*^9, {3.7216018081844997`*^9, 3.721601867557898*^9}, 
   3.7216019158575993`*^9, 3.721601955761297*^9, 3.721602012060091*^9, 
   3.7216020551098757`*^9, 3.721602122209738*^9, 3.721602153971483*^9, 
   3.721602194655582*^9, {3.7216022913637857`*^9, 3.7216023170199327`*^9}, 
   3.721602427418811*^9, 3.7216025049579144`*^9, 3.721602766143175*^9, {
   3.7216028286075087`*^9, 3.721602891030652*^9}, 3.721602921390072*^9, 
   3.7216029560750513`*^9, {3.721603056104291*^9, 3.721603067845221*^9}, 
   3.721603124393818*^9, {3.721603470635396*^9, 3.7216035104478493`*^9}, 
   3.7216035802925262`*^9, 3.7216036571189623`*^9, {3.7216036959592333`*^9, 
   3.721603712319971*^9}, 3.721603935400074*^9, 
   3.7216040059610157`*^9},ExpressionUUID->"34273d34-a84d-4649-a6e5-\
5caea503cbd5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.03326717448823224`"}], ",", "0.9993094893782701`", ",", 
     "0.01654815952622235`", ",", 
     RowBox[{"-", "0.3596015749322823`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5272247517221106`", ",", "0.031612770944233315`", ",", 
     RowBox[{"-", "0.8491376234103256`"}], ",", "21.4791945844977`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8490744148823166`", ",", "0.019523811109759745`", ",", 
     "0.5279123659069453`", ",", "0.2020685879147397`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", "1.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.721600410280508*^9, 3.721600448537871*^9, {3.7216005093621807`*^9, 
   3.721600549005908*^9}, 3.721600591101737*^9, {3.721600653661416*^9, 
   3.7216007049138117`*^9}, {3.721600742024713*^9, 3.721600790853889*^9}, 
   3.721600885259098*^9, 3.7216010904539957`*^9, 3.721601140751854*^9, {
   3.721601204859228*^9, 3.72160125184269*^9}, 3.7216015017950087`*^9, 
   3.7216015372812557`*^9, {3.7216018081844997`*^9, 3.721601867557898*^9}, 
   3.7216019158575993`*^9, 3.721601955761297*^9, 3.721602012060091*^9, 
   3.7216020551098757`*^9, 3.721602122209738*^9, 3.721602153971483*^9, 
   3.721602194655582*^9, {3.7216022913637857`*^9, 3.7216023170199327`*^9}, 
   3.721602427418811*^9, 3.7216025049579144`*^9, 3.721602766143175*^9, {
   3.7216028286075087`*^9, 3.721602891030652*^9}, 3.721602921390072*^9, 
   3.7216029560750513`*^9, {3.721603056104291*^9, 3.721603067845221*^9}, 
   3.721603124393818*^9, {3.721603470635396*^9, 3.7216035104478493`*^9}, 
   3.7216035802925262`*^9, 3.7216036571189623`*^9, {3.7216036959592333`*^9, 
   3.721603712319971*^9}, 3.721603935400074*^9, 
   3.7216040059631042`*^9},ExpressionUUID->"63a41cd7-4d5b-4343-8a08-\
40508e1c3f41"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5039892043526668`", ",", 
     RowBox[{"-", "0.016162498022588845`"}], ",", 
     RowBox[{"-", "0.8635587175322389`"}], ",", "21.452351502283754`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0009332213319959703`"}], ",", 
     RowBox[{"-", "0.9998345035959167`"}], ",", "0.018168407821621213`", ",", 
     "0.4552841954153055`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8637094498288416`", ",", "0.008350786811612831`", ",", 
     "0.5039208743672821`", ",", "0.28675009018920505`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", "1.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.721600410280508*^9, 3.721600448537871*^9, {3.7216005093621807`*^9, 
   3.721600549005908*^9}, 3.721600591101737*^9, {3.721600653661416*^9, 
   3.7216007049138117`*^9}, {3.721600742024713*^9, 3.721600790853889*^9}, 
   3.721600885259098*^9, 3.7216010904539957`*^9, 3.721601140751854*^9, {
   3.721601204859228*^9, 3.72160125184269*^9}, 3.7216015017950087`*^9, 
   3.7216015372812557`*^9, {3.7216018081844997`*^9, 3.721601867557898*^9}, 
   3.7216019158575993`*^9, 3.721601955761297*^9, 3.721602012060091*^9, 
   3.7216020551098757`*^9, 3.721602122209738*^9, 3.721602153971483*^9, 
   3.721602194655582*^9, {3.7216022913637857`*^9, 3.7216023170199327`*^9}, 
   3.721602427418811*^9, 3.7216025049579144`*^9, 3.721602766143175*^9, {
   3.7216028286075087`*^9, 3.721602891030652*^9}, 3.721602921390072*^9, 
   3.7216029560750513`*^9, {3.721603056104291*^9, 3.721603067845221*^9}, 
   3.721603124393818*^9, {3.721603470635396*^9, 3.7216035104478493`*^9}, 
   3.7216035802925262`*^9, 3.7216036571189623`*^9, {3.7216036959592333`*^9, 
   3.721603712319971*^9}, 3.721603935400074*^9, 
   3.721604005965225*^9},ExpressionUUID->"ddaed299-eb57-463a-86b7-\
045b8bf42a3c"]
}, Open  ]]
},
WindowSize->{1867, 1028},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7688, 198, 814, "Input",ExpressionUUID->"ef7c5052-93d1-4e3a-b7ec-1dbc8f44c7a8"],
Cell[8271, 222, 1355, 22, 35, "Output",ExpressionUUID->"0dcd49d4-6986-4951-912a-84dd532e6cd9"],
Cell[9629, 246, 1342, 22, 35, "Output",ExpressionUUID->"34273d34-a84d-4649-a6e5-5caea503cbd5"],
Cell[10974, 270, 1869, 36, 35, "Output",ExpressionUUID->"63a41cd7-4d5b-4343-8a08-40508e1c3f41"],
Cell[12846, 308, 1895, 37, 35, "Output",ExpressionUUID->"ddaed299-eb57-463a-86b7-045b8bf42a3c"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

