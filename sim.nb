(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48760,       1292]
NotebookOptionsPosition[     47758,       1253]
NotebookOutlinePosition[     48129,       1269]
CellTagsIndexPosition[     48086,       1266]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Model", " ", "Parameters"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]b", "=", 
     RowBox[{"60", " ", "2", 
      RowBox[{"Pi", "/", "360"}]}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{
    "angle", " ", "between", " ", "paired", " ", "legs", " ", "on", " ", 
     "the", " ", "bottom"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"rb", "=", "4"}], ";"}], "                            ", 
   RowBox[{"(*", 
    RowBox[{"radius", " ", "of", " ", "bottom"}], "*)"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"\[Theta]t", "=", 
     RowBox[{"5", " ", "2", 
      RowBox[{"Pi", "/", "360"}]}]}], ";"}], "   ", 
   RowBox[{"(*", 
    RowBox[{"leg", " ", "angle", " ", "on", " ", "top"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"rt", "=", "3"}], ";"}], "                      ", 
    RowBox[{"(*", 
     RowBox[{"radius", " ", "of", " ", "top"}], "*)"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", "10"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"equilibrium", " ", "height", " ", "of", " ", "the", " ", 
      RowBox[{"platform", ".", " ", "No"}], " ", "tilt"}], ",", " ", 
     RowBox[{"all", " ", "legs", " ", "0", " ", 
      RowBox[{"displacemnt", ".", " ", "The"}], " ", "eqilibrium", " ", 
      "length", " ", "is", " ", "calculated", " ", "based", " ", "on", " ", 
      "this", " ", "height"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l", " ", "=", " ", "1"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"radius", " ", "of", " ", "servo", " ", "horn"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"test", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]Range", " ", "=", " ", 
      RowBox[{"15", " ", "Degree"}]}], ";"}], " ", 
    RowBox[{"(*", 
     RowBox[{
     "desired", " ", "maximum", " ", "tilt", " ", "angle", " ", "in", " ", 
      "worst", " ", "case", " ", "direction", " ", "for", " ", "any", " ", 
      "position"}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lRange", " ", "=", " ", "6"}], ";", "                  ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"linear", " ", "range", " ", "to", " ", 
        RowBox[{"test", ".", " ", "x"}]}], "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "lRange"}], " ", "to"}], " ", "+", "lRange"}]}], ",", 
      " ", 
      RowBox[{"y", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "lRange"}], " ", "to"}], " ", "+", "lRange"}]}]}], 
     "*)"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]b", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "Pi"}], "-", 
        RowBox[{"3", "\[Theta]b"}]}], ")"}], "/", "3"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]t", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "Pi"}], "-", 
        RowBox[{"3", "\[Theta]t"}]}], ")"}], "/", "3"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]", "=", 
     RowBox[{"1", "/", "100"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ptsb", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"rb", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"ang", "-", 
             RowBox[{"\[Theta]b", "/", "2"}]}], "]"}], ",", 
           RowBox[{"Sin", "[", 
            RowBox[{"ang", "-", 
             RowBox[{"\[Theta]b", "/", "2"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ang", ",", "0", ",", 
          RowBox[{
           RowBox[{"2", "\[Pi]"}], "-", "\[Epsilon]"}], ",", 
          RowBox[{"\[Theta]b", "+", "\[Phi]b"}]}], "}"}]}], "]"}], "~", 
      "Riffle", "~", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"rb", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"ang", "-", 
             RowBox[{"\[Theta]b", "/", "2"}]}], "]"}], ",", 
           RowBox[{"Sin", "[", 
            RowBox[{"ang", "-", 
             RowBox[{"\[Theta]b", "/", "2"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ang", ",", "\[Theta]b", ",", 
          RowBox[{
           RowBox[{"2", "\[Pi]"}], "+", "\[Theta]b", "-", "\[Epsilon]"}], ",", 
          RowBox[{"\[Theta]b", "+", "\[Phi]b"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ptsb", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "&"}], "/@", "ptsb"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"ptsb", "=", 
     RowBox[{"Transpose", "[", "ptsb", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ptst", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"rt", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"ang", "-", 
             RowBox[{"\[Theta]t", "/", "2"}]}], "]"}], ",", 
           RowBox[{"Sin", "[", 
            RowBox[{"ang", "-", 
             RowBox[{"\[Theta]t", "/", "2"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ang", ",", "0", ",", 
          RowBox[{
           RowBox[{"2", "\[Pi]"}], "-", "\[Epsilon]"}], ",", 
          RowBox[{"\[Theta]t", "+", "\[Phi]t"}]}], "}"}]}], "]"}], "~", 
      "Riffle", "~", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"rt", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"ang", "-", 
             RowBox[{"\[Theta]t", "/", "2"}]}], "]"}], ",", 
           RowBox[{"Sin", "[", 
            RowBox[{"ang", "-", 
             RowBox[{"\[Theta]t", "/", "2"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ang", ",", "\[Theta]t", ",", 
          RowBox[{
           RowBox[{"2", "\[Pi]"}], "+", "\[Theta]t", "-", "\[Epsilon]"}], ",", 
          RowBox[{"\[Theta]t", "+", "\[Phi]t"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"ptst", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "&"}], "/@", "ptst"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"ptst", "=", 
     RowBox[{"Transpose", "[", "ptst", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"rotMat", "[", 
      RowBox[{"\[Alpha]_", ",", "\[Beta]_", ",", "\[Gamma]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "~", "Join", "~", 
          RowBox[{"{", "0", "}"}]}], "&"}], "/@", 
        RowBox[{"RollPitchYawMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], 
         "]"}]}], ")"}], "~", "Join", "~", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"j", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"norm", "[", "x_", "]"}], ":=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"x", ".", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"unit", "[", "x_", "]"}], ":=", 
     RowBox[{"x", "/", 
      RowBox[{"norm", "[", "x", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"normMat", "[", 
     RowBox[{"u_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l", "=", 
        RowBox[{
         RowBox[{"j", "*", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"i", "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], "}"}], ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"unit", "[", 
           RowBox[{"l", "~", "Cross", "~", "u"}], "]"}], " ", "~", "Join", 
          "~", 
          RowBox[{"{", "0", "}"}]}], ",", 
         RowBox[{
          RowBox[{"unit", "[", 
           RowBox[{"u", "~", "Cross", "~", 
            RowBox[{"unit", "[", 
             RowBox[{"l", "~", "Cross", "~", "u"}], "]"}]}], "]"}], "~", 
          "Join", "~", 
          RowBox[{"{", "0", "}"}]}], ",", 
         RowBox[{
          RowBox[{"unit", "[", "u", "]"}], "~", "Join", "~", 
          RowBox[{"{", "0", "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"normMat", "[", "u_", "]"}], " ", ":=", " ", 
     RowBox[{"normMat", "[", 
      RowBox[{"u", ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"normMat", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "\[Theta]_"}], "]"}], ":=", 
     RowBox[{"normMat", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[Theta]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"normMat", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
     RowBox[{"normMat", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tMat", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "x"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "y"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "z"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"top", "[", 
      RowBox[{"x_", ",", "y_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"tMat", "[", 
       RowBox[{"x", ",", "y", ",", "h"}], "]"}], ".", 
      RowBox[{"normMat", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "]"}], ".", "ptst"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"top", "[", 
      RowBox[{"x_", ",", "y_", ",", "ux_", ",", "uy_", ",", "uz_"}], "]"}], 
     " ", ":=", 
     RowBox[{
      RowBox[{"tMat", "[", 
       RowBox[{"x", ",", "y", ",", "h"}], "]"}], ".", 
      RowBox[{"normMat", "[", 
       RowBox[{"ux", ",", "uy", ",", "uz"}], "]"}], ".", "ptst"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dists", "[", 
      RowBox[{"x_", ",", "y_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"norm", "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"top", "[", 
          RowBox[{"x", ",", "y", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "-",
          "ptsb"}], "]"}]}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dists", "[", 
      RowBox[{"x_", ",", "y_", ",", "ux_", ",", "uy_", ",", "uz_"}], "]"}], 
     " ", ":=", " ", 
     RowBox[{
      RowBox[{"norm", "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"top", "[", 
          RowBox[{"x", ",", "y", ",", "ux", ",", "uy", ",", "uz"}], "]"}], 
         "-", "ptsb"}], "]"}]}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"modelB", "[", "b_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"b", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], "~", "Join", "~", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"riffle", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Fold", "[", 
     RowBox[{"Join", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", "i"}], "-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", "i"}], "-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"2", "i"}], "]"}], "]"}], ",", 
          RowBox[{"y", "[", 
           RowBox[{"[", 
            RowBox[{"2", "i"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "x", "]"}], "/", "2"}]}], "}"}]}], "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"modelC", "[", 
      RowBox[{"b_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"riffle", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"b", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"t", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"model", "[", 
      RowBox[{"b_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"modelB", "[", "b", "]"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"modelB", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"modelC", "[", 
         RowBox[{"b", ",", "t"}], "]"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d0", " ", "=", 
     RowBox[{
      RowBox[{"dists", "[", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ln", "=", "150"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"atan", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "\[Equal]", "0"}], "&&", 
        RowBox[{"y", "\[Equal]", "0"}]}], ",", "0", ",", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Graphics3D", "[", 
      RowBox[{"model", "[", 
       RowBox[{"ptsb", ",", 
        RowBox[{"top", "[", 
         RowBox[{"x", ",", "y", ",", 
          RowBox[{"atan", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", "\[Phi]Range"}], "]"}]}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "lRange"}], ",", "lRange"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "lRange"}], ",", "lRange"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"distsWithinSpec", "[", 
      RowBox[{"x_", ",", "y_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
     RowBox[{"AllTrue", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", "d0"}], "]"}], "<", "l"}], "&"}], ",", 
         RowBox[{"dists", "[", 
          RowBox[{"x", ",", "y", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], 
        "]"}], ",", 
       RowBox[{"#", "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", 
          RowBox[{"atan", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", "\[Phi]Range"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "lRange"}], ",", "lRange", ",", 
          RowBox[{"2", " ", 
           RowBox[{"lRange", "/", "ln"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "lRange"}], ",", "lRange", ",", 
          RowBox[{"2", " ", 
           RowBox[{"lRange", "/", "ln"}]}]}], "}"}]}], "]"}], "//", "N"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"works", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"distsWithinSpec", "@@", "#"}], "&"}], ",", "t", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xAxis", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "lRange"}], ",", "lRange", ",", 
         RowBox[{"2", 
          RowBox[{"lRange", "/", "ln"}]}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yAxis", " ", "=", " ", "xAxis"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"list", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xAxis", "[", 
          RowBox[{"[", "x", "]"}], "]"}], ",", 
         RowBox[{"yAxis", "[", 
          RowBox[{"[", "y", "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"works", "[", 
            RowBox[{"[", 
             RowBox[{"x", ",", "y"}], "]"}], "]"}], ",", "1", ",", "0"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1", ",", "ln"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "1", ",", "ln"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"list", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"list", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ListDensityPlot", "[", "list", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Yellow", " ", "means", " ", "possible"}], ",", " ", 
     RowBox[{"blue", " ", "means", " ", "impossible"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "also", " ", "shows", " ", "what", " ", "the", " ", "patform", " ", 
     "looks", " ", "like", " ", "in", " ", "the", " ", "worst", " ", "case", 
     " ", "for", " ", "each", " ", "position"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.718107697639184*^9, 3.7181079055767355`*^9}, {
   3.718107939951923*^9, 3.7181082590316267`*^9}, {3.718108322908682*^9, 
   3.718108529759112*^9}, {3.718108603900215*^9, 3.7181086134315023`*^9}, {
   3.7181087780574703`*^9, 3.718108809479681*^9}, {3.718108921823534*^9, 
   3.7181089906827354`*^9}, {3.7181091023546185`*^9, 
   3.7181092038860598`*^9}, {3.7181092390572815`*^9, 
   3.7181093338178587`*^9}, {3.7181093875651164`*^9, 3.718109398064592*^9}, {
   3.7181094440780296`*^9, 3.7181095356358476`*^9}, {3.7181096524315424`*^9, 
   3.718109688868825*^9}, {3.7181097342279096`*^9, 3.718109774649577*^9}, {
   3.7181098277273417`*^9, 3.7181098734145765`*^9}, {3.7181102081331315`*^9, 
   3.718110226570515*^9}, {3.7181102679458632`*^9, 3.718110297118514*^9}, {
   3.718110358886126*^9, 3.7181104362794194`*^9}, {3.71811047267104*^9, 
   3.7181106575968437`*^9}, {3.7182871947206664`*^9, 
   3.7182872619083214`*^9}, {3.7182874937199497`*^9, 
   3.7182875851418386`*^9}, {3.718287619282468*^9, 3.718287628813736*^9}, {
   3.7182876718293524`*^9, 3.718287833141851*^9}, {3.71828786898565*^9, 
   3.718287897735786*^9}, {3.718287966992135*^9, 3.7182882763201027`*^9}, {
   3.7182883324763536`*^9, 3.718288332648226*^9}, {3.7182884473671923`*^9, 
   3.7182885208984222`*^9}, {3.7182885548984337`*^9, 
   3.7182886164296827`*^9}, {3.718288704955187*^9, 3.7182887374708023`*^9}, {
   3.718288780283311*^9, 3.718288836517742*^9}, {3.718288880595998*^9, 
   3.7182889211739397`*^9}, {3.718288958970826*^9, 3.718289091736478*^9}, {
   3.7182891970802155`*^9, 3.718289218798975*^9}, {3.718289260877139*^9, 
   3.718289272377285*^9}, {3.7182893480333567`*^9, 3.718289349674113*^9}, {
   3.7182893814709063`*^9, 3.718289471523975*^9}, {3.7182895037585363`*^9, 
   3.7182896423718557`*^9}, {3.718289719496893*^9, 3.7182897626843553`*^9}, {
   3.7182898303720407`*^9, 3.718289867293751*^9}, {3.7182899273720264`*^9, 
   3.7182899275906477`*^9}, {3.7182902421299257`*^9, 3.718290686754964*^9}, {
   3.718290721958093*^9, 3.7182912658641896`*^9}, {3.718291321067378*^9, 
   3.718291501707982*^9}, {3.718291534551772*^9, 3.7182915851142254`*^9}, {
   3.7182916336300335`*^9, 3.718291638083014*^9}, {3.718291700270526*^9, 
   3.7182917720361147`*^9}, {3.718291970007863*^9, 3.71829214430483*^9}, {
   3.7182922222265677`*^9, 3.7182922322578382`*^9}, {3.718292349351575*^9, 
   3.718292704836136*^9}, {3.7182927406330385`*^9, 3.7182927606172338`*^9}, {
   3.7182927988516674`*^9, 3.71829298828929*^9}, {3.718293019304753*^9, 
   3.718293022382881*^9}, {3.7182930597266283`*^9, 3.7182932144455686`*^9}, {
   3.7182932474766355`*^9, 3.7182932826797733`*^9}, {3.718293312836069*^9, 
   3.7182935608985405`*^9}, {3.7182936138360443`*^9, 
   3.7182936139299726`*^9}, {3.71829374663293*^9, 3.7182940903673267`*^9}, {
   3.7182941248829613`*^9, 3.7182941880548553`*^9}, {3.718294226007989*^9, 
   3.71829422628924*^9}, {3.7182942679301972`*^9, 3.718294268133319*^9}, {
   3.7182944025083575`*^9, 3.718294442117734*^9}, {3.718294479133388*^9, 
   3.718294479602253*^9}, {3.7182945116802177`*^9, 3.71829451750837*^9}, {
   3.71829455769589*^9, 3.718294580633348*^9}, {3.7182947175710163`*^9, 
   3.718295191039689*^9}, 3.718295232539648*^9, {3.7182952694615154`*^9, 
   3.718295290024192*^9}, {3.7182953375865326`*^9, 3.7182953377115345`*^9}, {
   3.718446161110449*^9, 3.7184461884742775`*^9}, {3.7184462215840793`*^9, 
   3.7184462216270757`*^9}, {3.718446274557804*^9, 3.718446282783755*^9}, {
   3.718446674553975*^9, 3.718446674628976*^9}, {3.7184467692289824`*^9, 
   3.7184467818899984`*^9}, {3.7184468451389885`*^9, 
   3.7184468752819886`*^9}, {3.718446928115996*^9, 3.7184469282319975`*^9}, {
   3.7184469628520017`*^9, 3.7184469629349957`*^9}, {3.7185536367225456`*^9, 
   3.718553716129319*^9}, {3.7185556004037304`*^9, 3.718555631294095*^9}, {
   3.718555793819811*^9, 3.7185557940229397`*^9}, {3.718563239037495*^9, 
   3.71856323913126*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cross", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b0", ",", "b1", ",", "b2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.718449175793928*^9, 3.7184492230912848`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "a2"}], " ", "b1"}], "+", 
    RowBox[{"a1", " ", "b2"}]}], ",", 
   RowBox[{
    RowBox[{"a2", " ", "b0"}], "-", 
    RowBox[{"a0", " ", "b2"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "a1"}], " ", "b0"}], "+", 
    RowBox[{"a0", " ", "b1"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.718449223763*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ptst", "//", "N"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7185506172630773`*^9, 3.7185506608264737`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2.9971446647455733`", "2.9971446647455733`", 
      RowBox[{"-", "1.3852458397051017`"}], 
      RowBox[{"-", "1.6118988250404713`"}], 
      RowBox[{"-", "1.6118988250404713`"}], 
      RowBox[{"-", "1.3852458397051017`"}]},
     {
      RowBox[{"-", "0.130858162096008`"}], "0.130858162096008`", 
      "2.6610324995346653`", "2.530174337438657`", 
      RowBox[{"-", "2.530174337438657`"}], 
      RowBox[{"-", "2.6610324995346653`"}]},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"1.`", "1.`", "1.`", "1.`", "1.`", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7185506480918274`*^9, 3.7185506611389184`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ptsb", "//", "N"}], " ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.718550775890935*^9, 3.7185507822972665`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3.4641016151377544`", "3.4641016151377544`", "0.`", 
      RowBox[{"-", "3.4641016151377544`"}], 
      RowBox[{"-", "3.4641016151377544`"}], "0.`"},
     {
      RowBox[{"-", "2.`"}], "2.`", "4.`", "2.`", 
      RowBox[{"-", "2.`"}], 
      RowBox[{"-", "4.`"}]},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"1.`", "1.`", "1.`", "1.`", "1.`", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.718550782625386*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"normMat", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], "//", "N"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.718551946870519*^9, 3.718551980543277*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.7071067811865475`", 
      RowBox[{"-", "0.4082482904638631`"}], "0.5773502691896258`", "0.`"},
     {"0.`", "0.816496580927726`", "0.5773502691896258`", "0.`"},
     {
      RowBox[{"-", "0.7071067811865475`"}], 
      RowBox[{"-", "0.4082482904638631`"}], "0.5773502691896258`", "0.`"},
     {"0.`", "0.`", "0.`", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.718551971339939*^9, 3.7185519809651513`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dists", "[", 
  RowBox[{"0", ",", "0", ",", "1", ",", "1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.7185535298183413`*^9, 3.718553555678053*^9}, {
  3.718553608972376*^9, 3.718553625113267*^9}, {3.718553738879505*^9, 
  3.7185537409732766`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10.195021203172889`", ",", "10.105167840118705`", ",", 
   "12.208764175485989`", ",", "12.175701130563287`", ",", 
   "14.565082017262045`", ",", "14.184473807484464`"}], "}"}]], "Output",
 CellChangeTimes->{{3.7185535478965516`*^9, 3.7185535559435053`*^9}, {
   3.7185536122067547`*^9, 3.718553625441228*^9}, 3.7185537417545357`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"k", ",", "k0", ",", "l"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BasePos", "[", "\[Phi]_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}], 
    RowBox[{"Cos", "[", "\[Phi]", "]"}], "l"}], "+", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}], 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "l"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TopPos", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"norm", "[", 
   RowBox[{"TopPos", "-", 
    RowBox[{"BasePos", "[", "\[Phi]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "/.", 
   RowBox[{"NSolve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"k", "[", "\[Phi]", "]"}], "\[Equal]", "k0"}], ",", "\[Phi]"}], 
    "]"}]}], "//", "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7185543553107653`*^9, 3.7185543843727293`*^9}, {
   3.7185544499971247`*^9, 3.7185545241374598`*^9}, {3.718554554543535*^9, 
   3.7185545942150335`*^9}, {3.7185546249023256`*^9, 
   3.7185547742613583`*^9}, {3.7185548111677713`*^9, 3.71855482687072*^9}, {
   3.7185548569959073`*^9, 3.7185548609175797`*^9}, {3.718554935855136*^9, 
   3.7185551368072996`*^9}, {3.718556173848024*^9, 3.718556244237512*^9}, {
   3.7185562747211323`*^9, 3.718556384422347*^9}, {3.7185564487805815`*^9, 
   3.7185565304675784`*^9}, {3.718556579308303*^9, 3.718556579386253*^9}, {
   3.7185567643409095`*^9, 3.718556772512889*^9}, {3.718558024216505*^9, 
   3.7185580379510517`*^9}, {3.718558075404673*^9, 3.7185582250004997`*^9}, {
   3.718558318478884*^9, 3.718558327603939*^9}, 3.718558378464471*^9, {
   3.718558411636829*^9, 3.7185584424967937`*^9}, {3.7185585068103733`*^9, 
   3.7185585135762477`*^9}, {3.718558800040563*^9, 3.718558870963962*^9}, {
   3.718559657252939*^9, 3.71855966634624*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", "1.`"}], " ", 
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{"0.5`", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1.`"}], " ", "l", " ", "x", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4.`", " ", 
                 SuperscriptBox["k0", "2"]}], "-", 
                RowBox[{"4.`", " ", 
                 SuperscriptBox["l", "2"]}], "-", 
                RowBox[{"4.`", " ", 
                 SuperscriptBox["x", "2"]}], "-", 
                RowBox[{"4.`", " ", 
                 SuperscriptBox["y", "2"]}], "-", 
                RowBox[{"4.`", " ", 
                 SuperscriptBox["z", "2"]}]}], ")"}]}], "-", 
             RowBox[{"4.`", " ", "l", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1.`"}], " ", 
                 SuperscriptBox["k0", "4"], " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["k0", "2"], " ", 
                 SuperscriptBox["l", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "-", 
                RowBox[{"1.`", " ", 
                 SuperscriptBox["l", "4"], " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["k0", "2"], " ", 
                 SuperscriptBox["x", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["l", "2"], " ", 
                 SuperscriptBox["x", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "-", 
                RowBox[{"1.`", " ", 
                 SuperscriptBox["x", "4"], " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["k0", "2"], " ", 
                 SuperscriptBox["y", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "-", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["l", "2"], " ", 
                 SuperscriptBox["y", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "-", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["x", "2"], " ", 
                 SuperscriptBox["y", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "-", 
                RowBox[{"1.`", " ", 
                 SuperscriptBox["y", "4"], " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["k0", "2"], " ", 
                 SuperscriptBox["z", "4"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["l", "2"], " ", 
                 SuperscriptBox["z", "4"]}], "-", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["x", "2"], " ", 
                 SuperscriptBox["z", "4"]}], "-", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["y", "2"], " ", 
                 SuperscriptBox["z", "4"]}], "-", 
                RowBox[{"1.`", " ", 
                 SuperscriptBox["z", "6"]}]}]]}]}], ")"}]}], 
          RowBox[{
           SuperscriptBox["l", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4.`", " ", 
              SuperscriptBox["x", "2"]}], "+", 
             RowBox[{"4.`", " ", 
              SuperscriptBox["z", "2"]}]}], ")"}]}]], "]"}]}]},
      {
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{"0.5`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1.`"}], " ", "l", " ", "x", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4.`", " ", 
                SuperscriptBox["k0", "2"]}], "-", 
               RowBox[{"4.`", " ", 
                SuperscriptBox["l", "2"]}], "-", 
               RowBox[{"4.`", " ", 
                SuperscriptBox["x", "2"]}], "-", 
               RowBox[{"4.`", " ", 
                SuperscriptBox["y", "2"]}], "-", 
               RowBox[{"4.`", " ", 
                SuperscriptBox["z", "2"]}]}], ")"}]}], "-", 
            RowBox[{"4.`", " ", "l", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "1.`"}], " ", 
                SuperscriptBox["k0", "4"], " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["k0", "2"], " ", 
                SuperscriptBox["l", "2"], " ", 
                SuperscriptBox["z", "2"]}], "-", 
               RowBox[{"1.`", " ", 
                SuperscriptBox["l", "4"], " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["k0", "2"], " ", 
                SuperscriptBox["x", "2"], " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["l", "2"], " ", 
                SuperscriptBox["x", "2"], " ", 
                SuperscriptBox["z", "2"]}], "-", 
               RowBox[{"1.`", " ", 
                SuperscriptBox["x", "4"], " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["k0", "2"], " ", 
                SuperscriptBox["y", "2"], " ", 
                SuperscriptBox["z", "2"]}], "-", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["l", "2"], " ", 
                SuperscriptBox["y", "2"], " ", 
                SuperscriptBox["z", "2"]}], "-", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["x", "2"], " ", 
                SuperscriptBox["y", "2"], " ", 
                SuperscriptBox["z", "2"]}], "-", 
               RowBox[{"1.`", " ", 
                SuperscriptBox["y", "4"], " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["k0", "2"], " ", 
                SuperscriptBox["z", "4"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["l", "2"], " ", 
                SuperscriptBox["z", "4"]}], "-", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["x", "2"], " ", 
                SuperscriptBox["z", "4"]}], "-", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["y", "2"], " ", 
                SuperscriptBox["z", "4"]}], "-", 
               RowBox[{"1.`", " ", 
                SuperscriptBox["z", "6"]}]}]]}]}], ")"}]}], 
         RowBox[{
          SuperscriptBox["l", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4.`", " ", 
             SuperscriptBox["x", "2"]}], "+", 
            RowBox[{"4.`", " ", 
             SuperscriptBox["z", "2"]}]}], ")"}]}]], "]"}]},
      {
       RowBox[{
        RowBox[{"-", "1.`"}], " ", 
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{"0.5`", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1.`"}], " ", "l", " ", "x", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4.`", " ", 
                 SuperscriptBox["k0", "2"]}], "-", 
                RowBox[{"4.`", " ", 
                 SuperscriptBox["l", "2"]}], "-", 
                RowBox[{"4.`", " ", 
                 SuperscriptBox["x", "2"]}], "-", 
                RowBox[{"4.`", " ", 
                 SuperscriptBox["y", "2"]}], "-", 
                RowBox[{"4.`", " ", 
                 SuperscriptBox["z", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4.`", " ", "l", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1.`"}], " ", 
                 SuperscriptBox["k0", "4"], " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["k0", "2"], " ", 
                 SuperscriptBox["l", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "-", 
                RowBox[{"1.`", " ", 
                 SuperscriptBox["l", "4"], " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["k0", "2"], " ", 
                 SuperscriptBox["x", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["l", "2"], " ", 
                 SuperscriptBox["x", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "-", 
                RowBox[{"1.`", " ", 
                 SuperscriptBox["x", "4"], " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["k0", "2"], " ", 
                 SuperscriptBox["y", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "-", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["l", "2"], " ", 
                 SuperscriptBox["y", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "-", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["x", "2"], " ", 
                 SuperscriptBox["y", "2"], " ", 
                 SuperscriptBox["z", "2"]}], "-", 
                RowBox[{"1.`", " ", 
                 SuperscriptBox["y", "4"], " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["k0", "2"], " ", 
                 SuperscriptBox["z", "4"]}], "+", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["l", "2"], " ", 
                 SuperscriptBox["z", "4"]}], "-", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["x", "2"], " ", 
                 SuperscriptBox["z", "4"]}], "-", 
                RowBox[{"2.`", " ", 
                 SuperscriptBox["y", "2"], " ", 
                 SuperscriptBox["z", "4"]}], "-", 
                RowBox[{"1.`", " ", 
                 SuperscriptBox["z", "6"]}]}]]}]}], ")"}]}], 
          RowBox[{
           SuperscriptBox["l", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4.`", " ", 
              SuperscriptBox["x", "2"]}], "+", 
             RowBox[{"4.`", " ", 
              SuperscriptBox["z", "2"]}]}], ")"}]}]], "]"}]}]},
      {
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{"0.5`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1.`"}], " ", "l", " ", "x", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4.`", " ", 
                SuperscriptBox["k0", "2"]}], "-", 
               RowBox[{"4.`", " ", 
                SuperscriptBox["l", "2"]}], "-", 
               RowBox[{"4.`", " ", 
                SuperscriptBox["x", "2"]}], "-", 
               RowBox[{"4.`", " ", 
                SuperscriptBox["y", "2"]}], "-", 
               RowBox[{"4.`", " ", 
                SuperscriptBox["z", "2"]}]}], ")"}]}], "+", 
            RowBox[{"4.`", " ", "l", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "1.`"}], " ", 
                SuperscriptBox["k0", "4"], " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["k0", "2"], " ", 
                SuperscriptBox["l", "2"], " ", 
                SuperscriptBox["z", "2"]}], "-", 
               RowBox[{"1.`", " ", 
                SuperscriptBox["l", "4"], " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["k0", "2"], " ", 
                SuperscriptBox["x", "2"], " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["l", "2"], " ", 
                SuperscriptBox["x", "2"], " ", 
                SuperscriptBox["z", "2"]}], "-", 
               RowBox[{"1.`", " ", 
                SuperscriptBox["x", "4"], " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["k0", "2"], " ", 
                SuperscriptBox["y", "2"], " ", 
                SuperscriptBox["z", "2"]}], "-", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["l", "2"], " ", 
                SuperscriptBox["y", "2"], " ", 
                SuperscriptBox["z", "2"]}], "-", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["x", "2"], " ", 
                SuperscriptBox["y", "2"], " ", 
                SuperscriptBox["z", "2"]}], "-", 
               RowBox[{"1.`", " ", 
                SuperscriptBox["y", "4"], " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["k0", "2"], " ", 
                SuperscriptBox["z", "4"]}], "+", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["l", "2"], " ", 
                SuperscriptBox["z", "4"]}], "-", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["x", "2"], " ", 
                SuperscriptBox["z", "4"]}], "-", 
               RowBox[{"2.`", " ", 
                SuperscriptBox["y", "2"], " ", 
                SuperscriptBox["z", "4"]}], "-", 
               RowBox[{"1.`", " ", 
                SuperscriptBox["z", "6"]}]}]]}]}], ")"}]}], 
         RowBox[{
          SuperscriptBox["l", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4.`", " ", 
             SuperscriptBox["x", "2"]}], "+", 
            RowBox[{"4.`", " ", 
             SuperscriptBox["z", "2"]}]}], ")"}]}]], "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7185581679369774`*^9, 3.718558225297388*^9}, {
   3.7185583197913003`*^9, 3.7185583279320564`*^9}, 3.718558378964306*^9, 
   3.718558435137261*^9, 3.7185585141229615`*^9, {3.7185588012122936`*^9, 
   3.7185588730420847`*^9}, {3.718559659565135*^9, 3.7185596667991467`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"4.", " ", "l", " ", 
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1."}], " ", 
     RowBox[{"k0", "^", "4"}], " ", 
     RowBox[{"z", "^", "2"}]}], "+", 
    RowBox[{"2.", " ", 
     RowBox[{"k0", "^", "2"}], " ", 
     RowBox[{"l", "^", "2"}], " ", 
     RowBox[{"z", "^", "2"}]}], "-", 
    RowBox[{"1.", " ", 
     RowBox[{"l", "^", "4"}], " ", 
     RowBox[{"z", "^", "2"}]}], "+", 
    RowBox[{"2.", " ", 
     RowBox[{"k0", "^", "2"}], " ", 
     RowBox[{"x", "^", "2"}], " ", 
     RowBox[{"z", "^", "2"}]}], "+", 
    RowBox[{"2.", " ", 
     RowBox[{"l", "^", "2"}], " ", 
     RowBox[{"x", "^", "2"}], " ", 
     RowBox[{"z", "^", "2"}]}], "-", 
    RowBox[{"1.", " ", 
     RowBox[{"x", "^", "4"}], " ", 
     RowBox[{"z", "^", "2"}]}], "+", 
    RowBox[{"2.", " ", 
     RowBox[{"k0", "^", "2"}], " ", 
     RowBox[{"y", "^", "2"}], " ", 
     RowBox[{"z", "^", "2"}]}], "-", 
    RowBox[{"2.", " ", 
     RowBox[{"l", "^", "2"}], " ", 
     RowBox[{"y", "^", "2"}], " ", 
     RowBox[{"z", "^", "2"}]}], "-", 
    RowBox[{"2.", " ", 
     RowBox[{"x", "^", "2"}], " ", 
     RowBox[{"y", "^", "2"}], " ", 
     RowBox[{"z", "^", "2"}]}], "-", 
    RowBox[{"1.", " ", 
     RowBox[{"y", "^", "4"}], " ", 
     RowBox[{"z", "^", "2"}]}], "+", 
    RowBox[{"2.", " ", 
     RowBox[{"k0", "^", "2"}], " ", 
     RowBox[{"z", "^", "4"}]}], "+", 
    RowBox[{"2.", " ", 
     RowBox[{"l", "^", "2"}], " ", 
     RowBox[{"z", "^", "4"}]}], "-", 
    RowBox[{"2.", " ", 
     RowBox[{"x", "^", "2"}], " ", 
     RowBox[{"z", "^", "4"}]}], "-", 
    RowBox[{"2.", " ", 
     RowBox[{"y", "^", "2"}], " ", 
     RowBox[{"z", "^", "4"}]}], "-", 
    RowBox[{"1.", " ", 
     RowBox[{"z", "^", "6"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.718558610952385*^9, 3.718558610952385*^9}}]
},
WindowSize->{958, 988},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
Magnification:>1.3 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 23470, 615, 1940, "Input"],
Cell[CellGroupData[{
Cell[24053, 639, 273, 7, 39, "Input"],
Cell[24329, 648, 398, 14, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24764, 667, 156, 3, 39, "Input"],
Cell[24923, 672, 1166, 28, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26126, 705, 159, 3, 39, "Input"],
Cell[26288, 710, 963, 25, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27288, 740, 222, 6, 39, "Input"],
Cell[27513, 748, 952, 23, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28502, 776, 279, 5, 39, "Input"],
Cell[28784, 783, 378, 7, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29199, 795, 2041, 43, 165, "Input"],
Cell[31243, 840, 14659, 353, 290, "Output"]
}, Open  ]],
Cell[45917, 1196, 1837, 55, 83, "Input"]
}
]
*)

